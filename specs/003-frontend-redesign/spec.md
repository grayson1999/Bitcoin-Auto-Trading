# Feature Specification: Frontend Redesign - Bitcoin Auto Trading Dashboard

**Feature Branch**: `003-frontend-redesign`
**Created**: 2026-01-24
**Status**: Draft
**Input**: User description: "Frontend Redesign - 비트코인 자동 거래 대시보드 재설계. 기존 프론트엔드 삭제 후 새로운 구조로 재구축. 캔들스틱 차트, 기술적 지표, 포트폴리오 페이지, 관리자 전용 모니터링 페이지 추가."

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 실시간 시세 및 포지션 모니터링 (Priority: P1)

사용자가 대시보드에 접속하여 비트코인 현재가를 캔들스틱 차트로 확인하고, 기술적 지표(MA, RSI, MACD)를 오버레이하여 시장 상황을 분석한다. 또한 현재 보유 포지션, 미실현 손익, 계좌 잔고를 한눈에 파악한다.

**Why this priority**: 트레이딩 시스템의 핵심 기능으로, 사용자가 실시간 시장 상황과 자산 현황을 파악하는 것이 모든 의사결정의 기반이 된다.

**Independent Test**: 대시보드 페이지만 구현하면 사용자는 시세 확인, 차트 분석, 포지션 확인이 가능하여 기본적인 모니터링 가치를 제공한다.

**Acceptance Scenarios**:

1. **Given** 사용자가 로그인한 상태, **When** 대시보드에 접속, **Then** 캔들스틱 차트에 현재 비트코인 시세가 표시되고 5초마다 자동 갱신된다
2. **Given** 캔들스틱 차트가 표시된 상태, **When** 시간 간격(1분/5분/15분/1시간)을 선택, **Then** 선택한 간격의 캔들스틱으로 차트가 변경된다
3. **Given** 차트가 표시된 상태, **When** 기술적 지표(MA/RSI/MACD)를 토글, **Then** 해당 지표가 차트에 오버레이되거나 제거된다
4. **Given** 사용자가 비트코인을 보유한 상태, **When** 대시보드 접속, **Then** 포지션 카드에 보유량, 평균 매수가, 현재 평가금액, 미실현 손익(금액/%)이 표시된다

---

### User Story 2 - 포트폴리오 수익 현황 확인 (Priority: P1)

사용자가 포트폴리오 페이지에서 누적 수익률과 오늘 수익률을 정확한 계산 로직으로 확인한다. 거래 성과 통계(승률, MDD)도 함께 확인한다.

**Why this priority**: 투자 성과 추적은 자동 거래 시스템의 핵심 가치이며, 사용자가 시스템 효과를 판단하는 기준이 된다.

**Independent Test**: 포트폴리오 페이지만 구현하면 사용자는 투자 성과를 수치로 확인하여 시스템 신뢰도를 평가할 수 있다.

**Acceptance Scenarios**:

1. **Given** 사용자가 입금 기록이 있는 상태, **When** 포트폴리오 페이지 접속, **Then** 누적 수익률이 `(현재 총 평가금액 - 총 입금액) / 총 입금액 × 100`으로 계산되어 표시된다 (추가 입금은 수익으로 계산되지 않음)
2. **Given** 오늘 거래 기록이 있는 상태, **When** 포트폴리오 페이지 접속, **Then** 오늘 수익률이 `오늘 실현 손익 / 오늘 시작 잔고 × 100`으로 계산되어 표시된다
3. **Given** 사용자가 여러 번 거래한 기록이 있는 상태, **When** 포트폴리오 페이지 접속, **Then** 승률(이익 거래 수 / 전체 거래 수), 평균 수익률, 최대 낙폭(MDD)이 표시된다
4. **Given** 사용자가 첫 거래를 체결하지 않은 상태, **When** 포트폴리오 페이지 접속, **Then** "아직 거래 기록이 없습니다" 메시지와 함께 빈 상태가 표시된다

---

### User Story 3 - AI 신호 확인 및 분석 (Priority: P2)

사용자가 AI가 생성한 매매 신호 목록을 카드 그리드와 타임라인 뷰로 확인하고, 각 신호의 상세 분석 근거를 모달로 확인한다.

**Why this priority**: AI 신호는 자동 거래의 핵심이지만, 대시보드와 포트폴리오가 먼저 구현되어야 신호의 맥락을 이해할 수 있다.

**Independent Test**: 신호 페이지만 구현하면 사용자는 AI 분석 결과를 검토하고 시스템 신뢰도를 판단할 수 있다.

**Acceptance Scenarios**:

1. **Given** AI 신호가 생성된 상태, **When** Signals 페이지 접속, **Then** 신호 카드 그리드에 BUY/SELL/HOLD 신호가 색상 구분되어 표시된다
2. **Given** 신호 목록이 표시된 상태, **When** 타임라인 뷰로 전환, **Then** 신호가 시간순으로 타임라인 형태로 표시된다
3. **Given** 신호 카드가 표시된 상태, **When** 특정 신호 카드 클릭, **Then** 모달에 신뢰도 점수, 분석 근거, 기술적 스냅샷이 표시된다
4. **Given** 신호 목록이 표시된 상태, **When** 신호 타입(BUY/SELL/HOLD) 필터 선택, **Then** 선택한 타입의 신호만 필터링되어 표시된다

---

### User Story 4 - 주문 내역 조회 (Priority: P2)

사용자가 체결된 주문과 대기 중인 주문의 내역을 테이블 형태로 조회하고, 상태별로 필터링한다.

**Why this priority**: 주문 내역은 거래 추적에 필수적이지만, 대시보드와 포트폴리오의 기반이 되므로 해당 기능 이후에 구현한다.

**Independent Test**: 주문 페이지만 구현하면 사용자는 모든 거래 이력을 검토할 수 있다.

**Acceptance Scenarios**:

1. **Given** 주문 기록이 있는 상태, **When** Orders 페이지 접속, **Then** 주문 테이블에 주문 ID, 타입, 가격, 수량, 상태, 체결 시간이 표시된다
2. **Given** 주문 목록이 표시된 상태, **When** 상태 필터(전체/대기/체결/취소/실패) 선택, **Then** 선택한 상태의 주문만 필터링되어 표시된다
3. **Given** 주문이 20개 이상인 상태, **When** 페이지네이션 버튼 클릭, **Then** 다음 페이지의 주문 목록이 표시된다

---

### User Story 5 - 시스템 설정 관리 (Priority: P2)

사용자가 거래 파라미터(포지션 크기, 손절매, 일일 손실 한도)와 AI 설정(모델, 신호 주기)을 조정한다.

**Why this priority**: 시스템 커스터마이징은 중요하지만 기본 모니터링 기능이 먼저 동작해야 설정 변경의 효과를 확인할 수 있다.

**Independent Test**: 설정 페이지만 구현하면 사용자는 거래 전략을 조정할 수 있다.

**Acceptance Scenarios**:

1. **Given** Settings 페이지 접속, **When** 포지션 크기(최소/최대 %) 값 변경 후 저장, **Then** 변경된 값이 저장되고 성공 메시지가 표시된다
2. **Given** Settings 페이지 접속, **When** AI 모델(Gemini 2.5 Pro, GPT-4o 등) 선택 변경, **Then** 선택한 모델이 저장된다
3. **Given** 설정을 변경한 상태, **When** 초기화 버튼 클릭, **Then** 모든 설정이 기본값으로 복원된다

---

### User Story 6 - 관리자 서버 모니터링 (Priority: P3)

관리자가 Admin 페이지에서 백엔드 시스템 상태를 모니터링한다. 스케줄러 작업, DB 상태, 시스템 리소스, 디스크 용량을 확인한다.

**Why this priority**: 운영 모니터링은 시스템 안정성에 중요하지만, 핵심 거래 기능이 먼저 구현되어야 한다.

**Independent Test**: Admin 페이지만 구현하면 관리자는 시스템 상태를 점검하고 문제를 사전에 파악할 수 있다.

**Acceptance Scenarios**:

1. **Given** 관리자 권한 사용자가 로그인한 상태, **When** Admin 페이지 접속, **Then** 스케줄러 작업(데이터 수집, 신호 생성, 주문 동기화) 상태가 표시된다
2. **Given** Admin 페이지 접속, **When** 데이터베이스 상태 섹션 확인, **Then** 커넥션 풀 사용량, 쿼리 성능 지표가 표시된다
3. **Given** Admin 페이지 접속, **When** 시스템 리소스 섹션 확인, **Then** CPU 사용률, 메모리 사용률이 표시된다
4. **Given** Admin 페이지 접속, **When** 디스크 용량 섹션 확인, **Then** 볼륨 사용량, 여유 공간, 사용률 %가 표시된다
5. **Given** 일반 사용자(user 권한)가 로그인한 상태, **When** Admin 페이지 URL 접근, **Then** 접근이 거부되고 대시보드로 리다이렉트된다

---

### Edge Cases

- 네트워크 오류 시 어떻게 처리되는가? → 오류 메시지 표시 및 재시도 버튼 제공
- API 응답이 5초 이상 지연될 경우 어떻게 처리되는가? → 로딩 상태 표시 및 타임아웃 메시지
- 세션 만료 시 어떻게 처리되는가? → 자동으로 토큰 갱신 시도, 실패 시 로그인 페이지로 리다이렉트
- 거래 기록이 없는 신규 사용자의 포트폴리오는 어떻게 표시되는가? → 빈 상태 메시지와 가이드 표시
- 차트 데이터가 없는 기간을 조회할 경우 어떻게 처리되는가? → "데이터 없음" 메시지 표시

## Requirements *(mandatory)*

### Functional Requirements

**대시보드**
- **FR-001**: 시스템은 캔들스틱 차트로 비트코인 시세를 표시해야 한다 (기본 100개 캔들)
- **FR-002**: 시스템은 1분/5분/15분/1시간 간격의 캔들스틱을 지원해야 한다
- **FR-003**: 시스템은 MA(20, 50, 200), RSI, MACD 기술적 지표를 차트에 오버레이할 수 있어야 한다
- **FR-004**: 시스템은 현재 포지션(보유량, 평균가, 평가금액, 미실현 손익)을 표시해야 한다
- **FR-005**: 시스템은 계좌 잔고(KRW, BTC, 총 평가금액)를 표시해야 한다
- **FR-006**: 시스템은 5초 간격으로 데이터를 자동 갱신해야 한다

**포트폴리오**
- **FR-007**: 시스템은 누적 수익률을 `(현재 총 평가금액 - 총 입금액) / 총 입금액 × 100`으로 계산해야 한다
- **FR-008**: 시스템은 입금 내역(최초 입금 + 추가 입금)을 추적하여 총 입금액을 정확히 관리해야 한다
- **FR-009**: 시스템은 오늘 수익률을 `오늘 실현 손익 / 오늘 시작 잔고 × 100`으로 계산해야 한다
- **FR-010**: 시스템은 승률, 평균 수익률, 최대 낙폭(MDD)을 계산하여 표시해야 한다
- **FR-010a**: 시스템은 수익률 차트를 기본 30일 기간으로 표시해야 한다

**신호**
- **FR-011**: 시스템은 AI 신호를 카드 그리드 형태로 최신순 정렬하여 표시해야 한다
- **FR-012**: 시스템은 AI 신호를 타임라인 형태로 표시할 수 있어야 한다
- **FR-013**: 시스템은 신호 타입(BUY/SELL/HOLD)별 필터링을 지원해야 한다
- **FR-014**: 시스템은 신호 클릭 시 상세 분석 근거를 모달로 표시해야 한다

**주문**
- **FR-015**: 시스템은 주문 내역을 테이블 형태로 최신순 정렬하여 표시해야 한다
- **FR-016**: 시스템은 주문 상태(전체/대기/체결/취소/실패)별 필터링을 지원해야 한다
- **FR-017**: 시스템은 주문 목록에 페이지네이션을 제공해야 한다

**설정**
- **FR-018**: 시스템은 포지션 크기(최소/최대 %), 손절매, 일일 손실 한도 설정을 지원해야 한다
- **FR-019**: 시스템은 AI 모델 및 신호 생성 주기 설정을 지원해야 한다
- **FR-020**: 시스템은 설정 초기화 기능을 제공해야 한다

**관리자**
- **FR-021**: 시스템은 관리자 권한 사용자만 Admin 페이지에 접근할 수 있어야 한다
- **FR-022**: 시스템은 스케줄러 작업 상태를 표시해야 한다
- **FR-023**: 시스템은 데이터베이스 커넥션 풀 및 쿼리 성능을 표시해야 한다
- **FR-024**: 시스템은 CPU, 메모리 사용률을 표시해야 한다
- **FR-025**: 시스템은 디스크/볼륨 용량(사용량, 여유 공간, 사용률 %)을 표시하고, 70% 이상 시 경고를 표시해야 한다

**인증**
- **FR-026**: 시스템은 JWT 토큰 기반 인증을 사용해야 한다
- **FR-027**: 시스템은 토큰 만료 전 자동 갱신을 수행해야 한다
- **FR-028**: 시스템은 역할 기반 접근 제어(user, admin)를 지원해야 한다

### Key Entities

- **Market Data**: 비트코인 시세 정보 (현재가, 고가, 저가, 거래량, 타임스탬프)
- **Position**: 보유 포지션 (심볼, 수량, 평균 매수가, 현재 평가금액, 미실현 손익)
- **Balance**: 계좌 잔고 (KRW, BTC, 총 평가금액)
- **Trading Signal**: AI 매매 신호 (타입, 신뢰도, 분석 근거, 생성 시간)
- **Order**: 주문 (타입, 가격, 수량, 상태, 체결 시간)
- **Daily Stats**: 일일 통계 (시작 잔고, 종료 잔고, 실현 손익, 거래 횟수, 승률)
- **Deposit History**: 입금 내역 (입금 금액, 입금 일시, 누적 총 입금액)
- **System Config**: 시스템 설정 (키-값 쌍)
- **User**: 사용자 (ID, 이메일, 이름, 역할)

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 사용자가 대시보드 로딩 후 3초 이내에 캔들스틱 차트와 포지션 정보를 확인할 수 있다
- **SC-002**: 차트의 시간 간격 변경 시 1초 이내에 새로운 캔들스틱이 표시된다
- **SC-003**: 포트폴리오 페이지에서 누적 수익률과 오늘 수익률이 정확한 계산 공식으로 표시된다
- **SC-004**: 일반 사용자가 Admin 페이지에 접근 시도 시 100% 차단된다
- **SC-005**: 네트워크 오류 발생 시 사용자에게 명확한 오류 메시지와 재시도 옵션이 제공된다
- **SC-006**: 모바일 환경(640px 미만)에서 모든 페이지가 정상적으로 표시되고 사용 가능하다

## Clarifications

### Session 2026-01-24

- Q: MA 지표의 기간(period) 설정은? → A: MA 20, 50, 200 (단기/중기/장기 조합)
- Q: 차트에 표시할 캔들 개수는? → A: 100개 (표준, 추세 파악 충분)
- Q: 디스크 용량 경고 임계값은? → A: 70% 이상 시 경고 (보수적)
- Q: 신호 및 주문 목록 기본 정렬 순서는? → A: 최신순 (최근 항목이 위에)
- Q: 포트폴리오 수익률 차트 기본 표시 기간은? → A: 30일 (월간 성과, 표준)
- Q: 누적 수익률 계산 시 추가 입금 처리는? → A: 총 입금액(최초 + 추가 입금) 기준으로 계산하여 입금을 수익으로 잘못 계산하는 것 방지

## Assumptions

- Auth Server(9000 포트)가 이미 운영 중이며 JWT 토큰 발급/갱신 기능을 제공한다
- 백엔드 API(8000 포트)가 이미 구현되어 있으며 필요한 엔드포인트를 제공한다
- 입금 내역 추적을 위한 백엔드 API 추가 구현이 필요하다 (입금 감지 및 기록)
- 포트폴리오 요약 API 추가 구현이 필요하다 (GET /api/v1/portfolio/summary)
- Admin 모니터링용 API 추가 구현이 필요하다 (시스템 리소스, 디스크 용량)
- 기존 프론트엔드 코드를 완전히 삭제하고 새로 구축한다
